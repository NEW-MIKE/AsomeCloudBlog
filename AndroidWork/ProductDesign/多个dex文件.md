工作中常用到反编译apk，但是apk下面不仅仅只有一个dex文件，需求大的情况下会有很多个dex文件，一个个用dex2jar来反编译，再打开代码分析，很麻烦，所以把全部dex文件一次性反编译出来，很有必要。
1，分成多个dex文件的原因

dex文件，是将项目所需全部的class文件合并且压缩到里面，但是单个dex文件引用的方法总数不能超过65536，所以为了解决这个问题，谷歌推出了multidex技术，将一个apk文件中的dex拆分成多个分主次的dex文件来加载。
为什么是65536?因为一个dex文件中的方法个数采用原生类型short来索引，而short是4个字节，4个字节最大数据存储量是65536。
2，一次性反编译所有dex文件

例如一个app，改成zip解压缩之后，会发现它有很多dex文件：
在这里插入图片描述
那一个个反编译dex2jar很麻烦，这里有1个小技巧就是直接反编译全部apk，就会得到所有的代码，该apk文件放在dex2jar的文件夹下。
3，出现的错误

在实际操作中，不一定会把所有的dex文件都给反编译出来，第一次反编译的时候，时间很短，我就预感不太对，但是不是我的操作有误，百度了半天，也没找出来啥原因，最后还是google出来的，果然还是google强大。

dex2jar在2.0版本是不支持multidex的，如果你是2.0版本的（dex2jar-2.0），那么该版本不支持multidex，换新版本。
新版本（dex-tools-2.1-SNAPSHOT）是支持multidex的，直接运行2中的反编译代码即可出来所有代码。

不过，运气不好的情况下，会依然出错，依然出不来想要的代码，我就属于那个运气不好的，(/ □ )。
我下载了新版本，运行了代码，依然出错。Exception in thread “main” java.lang.OutOfMemoryError: Java heap space。
在这里插入图片描述
初步判断是jvm的原因，这里改一下jvm的运行大小，即可解决该错误。很多地方说是在d2j-dex2jar.bat中改jvm的大小，但是打开后发现改不了。
在这里插入图片描述
但是从这个代码里面我们可以看到从d2j_invoke.bat来设置java的环境，所以打开d2j_invoke.bat，修改该jvm大小，我这里改成2048，就不报错了。
在这里插入图片描述
如有错误，欢迎与我交流，vx: kathrianwly
